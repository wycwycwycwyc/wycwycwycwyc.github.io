<!DOCTYPE html>  
<html>  
<head>  
    <title>抢车票（普通版）</title>  
    <link rel="stylesheet" href="styles.css">
    <script src="script.js"></script>  
    <script src="script1.js"></script>  
    <script src="script4.js"></script>  
    <link rel="stylesheet" href="styles3.css">
    <script src="script5.js"></script>
    <style>  
    </style>
<!-- 引入样式文件 -->
<link rel="stylesheet" href="styles2.css">
<!-- 引入JavaScript文件 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js"></script>
 <script src="script2.js"></script>   
 <script src="script3.js"></script>
</head>
<script>
</script> 
</head>  
<body>  
    <div class="title">抢车票（普通版）</div>  
<button class="custom-button" onclick="goBackOrHome()">返回</button>
    <br>  
    <br>  
    <br>  
    <div class="subtitle">源代码</div>  
    <div class="content">  
        <pre id="sourceCode"><code class="language-python custom-variable">
# 等待一段时间，以便操作系统可以处理终止的进程    
from selenium import webdriver  
from selenium.webdriver.common.keys import Keys  
from selenium.webdriver.common.by import By  
from selenium.webdriver.support.ui import WebDriverWait  
from selenium.webdriver.support import expected_conditions as EC  #导入相关库
from selenium.webdriver import ActionChains   
import time
import os  
import psutil
driver = webdriver.Edge()  # 或者使用webdriver.Firefox()，取决于你使用的浏览器驱动程序  
driver.maximize_window()    
# 登录账号  
driver.get("https://kyfw.12306.cn/otn/resources/login.html")  
time.sleep(60)  #等待用户登录
driver.get("https://kyfw.12306.cn/otn/leftTicket/init?linktypeid=dc&fs=%E6%B8%A0%E5%8E%BF,QRW&ts=%E9%87%8D%E5%BA%86%E5%8C%97,CUW&date=2024-01-31&flag=N,N,Y")           
while True:  
    try:
        element = driver.find_element(By.ID, "preFilled1href")  # 确保你找到了正确的元素    
        action = ActionChains(driver)    
        action.click(element).perform() #点击查询按钮 
        time.sleep(0.2)   
        button1 = driver.find_element(By.XPATH, "//*[@id=\"ticket_77000K10640Z_01_03\"]/td[13]/a")  # 注意这里使用了By.XPATH而不是By.ID或者其他方式，并且要确保XPath是正确的。XPath可能需要根据网页结构进行调整。  
        button1.click() #点击预订按钮
        time.sleep(0.67)
        button2 = driver.find_element(By.XPATH, "//*[@id=\"dj_passenger_id\"]/li[3]/label") 
        button2.click()     #选择乘车人
        button3 = driver.find_element(By.XPATH, "//*[@id=\"seatType_1\"]")
        button3.click()     #点击席别
        button4 = driver.find_element(By.XPATH, "//*[@id=\"seatType_1\"]/option[1]")
        button4.click() #选择席别
        submitOrder_id = driver.find_element(By.ID, "submitOrder_id")
        submitOrder_id.click()  #确定提交
        time.sleep(0.5)
  
      
    # 等待一段时间，以便操作系统可以处理终止的进程  
        time.sleep(2.5)
        qr_submit_id = driver.find_element(By.ID, "qr_submit_id")
        qr_submit_id.click()
        time.sleep(600)
        print("抢票成功")
        break
    except:
        continue</code></pre>  
        <button id="copyCodeBtn" class="custom-button" onclick="copySourceCode()" style="position: absolute; top: 10px; right: 10px;">复制源代码</button>  <!-- 这里是修改的地方 -->    
    </div>  
    <div class="footer">
        <br>  
    <button class="custom-button" id="downloadSourceCodeBtn">下载源代码</button>  
    </div> <!-- 这里是修复的地方 -->
    <div id="tips">
        <span id="lightanddark">提示:切换白天黑夜请到主页<span>
    </div> 
<script>
// 检查用户的登录状态
function checkLoginStatus() {
    // 假设用户的登录状态存储在localStorage中，键名为'isLoggedIn'
    var isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
    return isLoggedIn;
}

// 为下载源代码按钮添加点击事件监听器
document.getElementById('downloadSourceCodeBtn').addEventListener('click', function() {
    if (checkLoginStatus()) {
        // 用户已登录，提供下载链接
        window.location.href = 'http://2frp.bibl.love:24754/'; // 替换为您的源代码下载路径
    } else {
        // 用户未登录，重定向到登录页面
        window.location.href = 'Login.html'; // 替换为您的登录页面URL
    }
});
</script>   
</body>  
</html>

