<!doctype html><html lang=zh-CN><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>XLS转XLSX转换器(基础数据转换)</title><link rel=stylesheet href=styles.css><link rel=stylesheet href=styles4.css><script src=script.js></script>
<script src=script3.js></script>
<script src=script4.js></script>
<link rel=stylesheet href=styles3.css><script src=script5.js></script>
<script src=script6.js></script>
<link rel=stylesheet href=styles4.css><script src=script8.js></script>
<link rel=stylesheet href=styles5.css><link rel=stylesheet href=styles6.css><script src=script9.js></script>
<script src=script10.js></script>
<link href=message.min.css rel=stylesheet><script src=message.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.5/jszip.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js></script><style>body{font-family:Arial,sans-serif;margin:0;padding:0;display:flex;flex-direction:column;min-height:100vh;background-color:#f7f7f7}header{width:100%;background-color:#f7f7f7;color:#000;text-align:center;padding:5px}#dropZone{border:2px dashed #ccc;padding:20px;text-align:center;margin:50px auto;width:1e3px;height:600px;display:flex;flex-direction:column;justify-content:center;align-items:center;background-color:#fff;box-shadow:0 2px 4px rgba(0,0,0,.1);border-radius:15px}.download-table{width:100%;margin-top:20px;border-collapse:collapse;border-radius:10px}.download-table td,.download-table th{border:1px solid #ddd;padding:8px}.download-table th{background-color:#f2f2f2}.download-table tr:nth-child(even){background-color:#f2f2f2}#downloadAllButton{display:block;margin:0 auto;margin-top:20px}@keyframes fadeIn{from{opacity:0}to{opacity:1}}body{font-family:Arial,sans-serif;margin:0;padding:0;display:flex;flex-direction:column;min-height:100vh;background-color:#f7f7f7;animation:fadeIn 1s ease-in-out}.download-table,#downloadAllButton{animation:fadeIn 1s ease-in-out}body.dark-mode{background-color:#121212;color:#fff}body.dark-mode header{background-color:#333;color:#fff}body.dark-mode #dropZone{border:2px dashed #555;background-color:#222;box-shadow:0 2px 4px rgba(255,255,255,.1)}body.dark-mode .download-table{color:#fff}body.dark-mode .download-table td,body.dark-mode .download-table th{border:1px solid #444}body.dark-mode .download-table th{background-color:#333}body.dark-mode .download-table tr:nth-child(even){background-color:#333}body.dark-mode{animation:fadeIn 1s ease-in-out}#loadingAnimation{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(0,0,0,.5);z-index:10000;backdrop-filter:blur(5px)}.spinner{border:5px solid #f3f3f3;border-top:5px solid #3498db;border-radius:50%;width:50px;height:50px;margin-bottom:20px;animation:spin 2s linear infinite}#loadingAnimation .spinner{border:5px solid #f3f3f3;border-top:5px solid #3498db;border-radius:50%;width:50px;height:50px;animation:spin 2s infinite;animation-timing-function:cubic-bezier(.25,.46,.45,.94)}#loadingAnimation{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:10000;display:flex;justify-content:center;align-items:center;flex-direction:column;font-size:24px;text-align:center}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style><div id=loadingAnimation class=hidden><div class=spinner></div><div class=loadingText>正在加载</div></div><header><h1>XLS转XLSX转换器(基础数据转换)</h1><button class=custom-button onclick=goBackOrHome()>返回</button></header><div id=dropZone><button class="file-upload-button custom-button" id=fileUploadButton>选择文件</button>
<input type=file id=fileInput accept=.xls multiple style=display:none><div>或者将XLS文件拖拽到这里转换为XLSX</div></div><table id=downloadLinks class="download-table hidden"><thead><tr><th>文件名<th>下载<tbody></table><button id=downloadAllButton class=custom-button>一键下载所有文件</button>
<script>function scriptLoaded(){var e=document.getElementById("loadingAnimation");e.style.display="none"}</script><script src=https://unpkg.com/xlsx/dist/xlsx.full.min.js onload=scriptLoaded()></script>
<script>const dropZone=document.getElementById("dropZone"),downloadLinksTable=document.getElementById("downloadLinks"),downloadAllButton=document.getElementById("downloadAllButton"),fileInput=document.getElementById("fileInput");dropZone.addEventListener("dragover",handleDragOver,!1),dropZone.addEventListener("drop",handleDrop,!1);function handleDragOver(e){e.stopPropagation(),e.preventDefault(),dropZone.style.border="2px dashed #000"}function handleDrop(e){e.stopPropagation(),e.preventDefault(),dropZone.style.border="2px dashed #ccc";const t=e.dataTransfer.files;processFiles(t,()=>{downloadLinksTable.classList.remove("hidden"),downloadAllButton.disabled=!1})}function processFiles(e,t){let n=0;const s=downloadLinksTable.getElementsByTagName("tbody")[0];for(let i=0;i<e.length;i++){const o=e[i];if(o.type==="application/vnd.ms-excel"){const i=new FileReader;i.onload=function(i){const d=i.target.result,u=XLSX.read(d,{type:"binary"}),h=XLSX.write(u,{bookType:"xlsx",type:"array"}),m=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),f=URL.createObjectURL(m),a=document.createElement("a");a.href=f,a.download=o.name.replace(".xls",".xlsx"),a.textContent=o.name.replace(".xls",".xlsx");const r=document.createElement("tr"),c=document.createElement("td"),l=document.createElement("td");c.textContent=o.name.replace(".xls",".xlsx"),l.appendChild(a),r.appendChild(c),r.appendChild(l),s.appendChild(r),n++,n===e.length&&t()},i.readAsBinaryString(o)}else alert("请只拖拽XLS文件。")}}downloadAllButton.addEventListener("click",function(){const e=downloadLinksTable.getElementsByTagName("a"),t=new JSZip;let n=0;function s(s,o){Qmsg.success("已开启下载"),fetch(s.href).then(e=>e.blob()).then(s=>{t.file(o,s),n++,n===e.length&&t.generateAsync({type:"blob"}).then(function(e){saveAs(e,"你的xlsx文件.zip")})}).catch(e=>console.error("下载失败:",e))}for(let t=0;t<e.length;t++){const n=e[t],o=n.download||"filename.xlsx";s(n,o)}}),document.getElementById("fileUploadButton").addEventListener("click",function(){fileInput.click()}),fileInput.addEventListener("change",function(e){processFiles(e.target.files,()=>{downloadLinksTable.classList.remove("hidden"),downloadAllButton.disabled=!1})})</script>