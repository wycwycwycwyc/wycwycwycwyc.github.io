<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><script src=script4.js></script><script src=script3.js></script><link rel=stylesheet href=styles3.css><script src=script5.js></script><link rel=stylesheet href=styles4.css><script src=script8.js></script><link rel=stylesheet href=styles5.css><link rel=stylesheet href=styles6.css><script src=script9.js></script><script src=script10.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js></script><title>更改密码</title><style>body{font-family:Arial,sans-serif;background-color:#f7f7f7;margin:0;padding:0;overflow:hidden}.container{width:400px;margin:50px auto;padding:30px;background-color:#fff;box-shadow:0 5px 20px #0003;border-radius:20px;position:relative}h1{text-align:center;color:#333}.input-group{margin-bottom:15px}.input-group label{display:block;margin-bottom:5px}.input-group input[type=password]{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box}button[type=button]{width:100%;padding:15px;border:none;border-radius:20px;background-color:#5cb85c;color:#fff;cursor:pointer;font-size:16px}button[type=button]:hover{background-color:#4cae4c}.loading-text{color:#666;font-size:14px;margin-top:10px;display:none}@keyframes slideUp{from{transform:translateY(100%);opacity:0}to{transform:translateY(0);opacity:1}}.back-btn{display:inline-block;padding:5px 10px;color:#5cb85c;text-decoration:none;font-size:16px;cursor:pointer;background-color:#f7f7f7;border:1px solid #ddd;border-radius:20px}.container{opacity:1;transform:translateY(0%);animation:slideUp .8s ease-out forwards}body.dark-mode{background-color:#1a1a1a;color:#fff}body.dark-mode .container{background-color:#272727;box-shadow:0 5px 20px #ffffff1a}body.dark-mode h1{color:#fff}body.dark-mode .input-group label{color:#ddd}body.dark-mode .input-group input[type=password]{background-color:#333;border-color:#444;color:#fff}body.dark-mode button[type=button]{background-color:#4caf50;color:#fff}body.dark-mode button[type=button]:hover{background-color:#45a049}body.dark-mode .loading-text{color:#aaa}body.dark-mode .back-btn{color:#4caf50;background-color:#333;border-color:#555}body.dark-mode .back-btn:hover{color:#45a049;background-color:#303030;border-color:#3c3c3c}body.dark-mode .input-group input[type=password]:focus{border-color:#4caf50;outline:none;box-shadow:0 0 0 2px #4caf5033}</style><div class=container><button class=back-btn onclick=goBackOrHome()>返回</button><h1>更改密码</h1><div class=input-group><label for=oldPassword>旧密码:</label>
<input type=password id=oldPassword name=oldPassword required></div><div class=input-group><label for=newPassword>新密码:</label>
<input type=password id=newPassword name=newPassword required></div><div class=input-group><label for=confirmNewPassword>确认新密码:</label>
<input type=password id=confirmNewPassword name=confirmNewPassword required></div><button type=button onclick=resetPassword()>提交</button><div class=loading-text id=loadingText>正在更改...</div><br><br><a href=forgotPassword.html>忘记密码</a>？</div><script>function resetPassword(){const isLoggedIn=localStorage.getItem('isLoggedIn')==='true';if(!isLoggedIn){swal('你还没登录!','登录后可更改','error');window.location.href="Login.html";return;}
const username=localStorage.getItem('username');const oldPassword=document.getElementById('oldPassword').value;const newPassword=document.getElementById('newPassword').value;const confirmNewPassword=document.getElementById('confirmNewPassword').value;if(newPassword!==confirmNewPassword){swal('新密码和确认新密码不一致!','新密码和确认新密码不一致！','error');return;}
const loadingText=document.getElementById('loadingText');loadingText.style.display='block';fetch('https://jbcfz.serveo.net/reset-password',{method:'POST',headers:{'Content-Type':'application/json',},body:JSON.stringify({username:username,oldPassword:oldPassword,newPassword:newPassword})}).then(response=>{if(!response.ok){throw new Error('Network response was not ok.');}
return response.text();}).then(html=>{loadingText.style.display='none';swal('密码更改成功','下次使用新密码登录','success');window.location.href='settings.html';}).catch(error=>{console.error('There was a problem with the fetch operation:',error);loadingText.style.display='none';alert('密码更改失败，请检查旧密码，或稍后重试。');});}</script>