<!doctype html><html lang=zh-cn><meta charset=utf-8><title>忘记密码</title><script src=script4.js></script><script src=script3.js></script><link rel=stylesheet href=styles3.css><script src=script5.js></script><link rel=stylesheet href=styles4.css><script src=script8.js></script><link rel=stylesheet href=styles5.css><link rel=stylesheet href=styles6.css><script src=script9.js></script><script src=script10.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js></script><style>body{font-family:Arial,sans-serif;background-color:#f7f7f7;margin:0;padding:0;overflow:hidden}.container{width:400px;margin:50px auto;padding:30px;background-color:#fff;box-shadow:0 5px 20px #0003;border-radius:20px;position:relative}h2{text-align:center;color:#333}label{display:block;margin-bottom:5px}input[type=email],input[type=password],input[type=verification_code],input[type=submit]{width:calc(100% - 22px);padding:10px;margin-bottom:10px;border:1px solid #ccc;border-radius:4px}input[type=verification_code]{width:65%}input[type=submit]{width:100%;padding:15px;border:none;border-radius:20px;background-color:#5cb85c;color:#fff;cursor:pointer;font-size:16px;display:block}input[type=submit]:hover{background-color:#4cae4c}.error{color:red;margin-bottom:10px}.back-button{display:inline-block;padding:5px 10px;color:#5cb85c;text-decoration:none;font-size:16px;cursor:pointer;background-color:#f7f7f7;border:1px solid #ddd;border-radius:20px}.back-button:hover{background-color:#e7e7e7}.verification-code-button{background-color:#4caf50;color:#fff;border:none;padding:8px 15px;margin-left:10px;border-radius:4px;cursor:pointer;font-size:14px}.verification-code-button:disabled{background-color:#ccc;cursor:not-allowed}@keyframes slideUp{from{transform:translateY(100%);opacity:0}to{transform:translateY(0);opacity:1}}.container{opacity:1;transform:translateY(0%);animation:slideUp .8s ease-out forwards}body.dark-mode{background-color:#1a1a1a;color:#fff}body.dark-mode .container{background-color:#272727;box-shadow:0 5px 20px #ffffff1a}body.dark-mode h2,body.dark-mode label{color:#fff}body.dark-mode input[type=email],body.dark-mode input[type=password],body.dark-mode input[type=verification_code]{background-color:#333;border-color:#444;color:#fff}body.dark-mode input[type=submit]{background-color:#4caf50;color:#fff}body.dark-mode input[type=submit]:hover{background-color:#45a049}body.dark-mode .error{color:#f55}body.dark-mode .back-button{color:#4caf50;background-color:#333;border-color:#555}body.dark-mode .back-button:hover{color:#45a049;background-color:#303030;border-color:#3c3c3c}body.dark-mode .verification-code-button{background-color:#4caf50;color:#fff}body.dark-mode .verification-code-button:disabled{background-color:#555;color:#999}</style><script>let lastSendTime=0;let countdown=60;function validateForm(event){var email=document.getElementById("email").value;var verificationCode=document.getElementById("verification_code").value;var newPassword=document.getElementById("new_password").value;var confirmPassword=document.getElementById("confirm_password").value;if(!verificationCode){document.getElementById("error_message").innerText="验证码不能为空！";return false;}else if(!newPassword){document.getElementById("error_message").innerText="新密码不能为空！";return false;}else if(newPassword!==confirmPassword){document.getElementById("error_message").innerText="新密码和确认新密码不一致！";return false;}
event.preventDefault();document.getElementById("submit_message").style.display="block";verifyCode();}
function sendVerificationCode(){const sendButton=document.getElementById("send_code_button");sendButton.disabled=true;sendButton.innerText="正在发送";var email=document.getElementById("email").value;const currentTime=Date.now();if(currentTime-lastSendTime<60000){swal("请1分钟后再尝试发送验证码。","请1分钟后再尝试发送验证码。",'error');return;}
fetch('https://jbcfz.serveo.net/send-verification-code',{method:'POST',headers:{'Content-Type':'application/json',},body:JSON.stringify({email:email})}).then(response=>{if(!response.ok){throw new Error('Network response was not ok');}
return response.text();}).then(data=>{swal('验证码发送成功','请查收您的邮箱','success');sendButton.innerText="发送成功";lastSendTime=Date.now();disableSendButton();}).catch(error=>{console.error('Error:',error);sendButton.disabled=false;sendButton.innerText="发送验证码";swal('验证码发送失败','请检查你的邮箱地址，或稍后重试。','error');});}
function disableSendButton(){const sendButton=document.getElementById("send_code_button");sendButton.disabled=true;sendButton.innerText="剩余 "+countdown+" 秒";const intervalId=setInterval(()=>{countdown--;sendButton.innerText="剩余 "+countdown+" 秒";if(countdown===0){clearInterval(intervalId);sendButton.innerText="发送验证码";countdown=60;sendButton.disabled=false;}},1000);}
function verifyCode(){var email=document.getElementById("email").value;var code=document.getElementById("verification_code").value;fetch('https://jbcfz.serveo.net/verify-code',{method:'POST',headers:{'Content-Type':'application/json',},body:JSON.stringify({email:email,code:code})}).then(response=>{if(!response.ok){throw new Error('Network response was not ok');}
return response.text();}).then(data=>{if(data==='验证码验证成功。'){resetPassword();}else{document.getElementById("error_message").innerText="验证码错误。";document.getElementById("submit_message").style.display="none";}}).catch(error=>{console.error('Error:',error);document.getElementById("error_message").innerText="验证码错误";document.getElementById("submit_message").style.display="none";});}
function resetPassword(){var email=document.getElementById("email").value;var newPassword=document.getElementById("new_password").value;fetch('https://jbcfz.serveo.net/reset-password-by-email',{method:'POST',headers:{'Content-Type':'application/json',},body:JSON.stringify({email:email,newPassword:newPassword})}).then(response=>{if(!response.ok){throw new Error('Network response was not ok');}
return response.text();}).then(data=>{swal("重置密码成功！",'你可以改用新密码登录','success');document.getElementById("submit_message").style.display="none";window.location.href='index.html';}).catch(error=>{console.error('Error:',error);swal('重置密码失败','请稍后重试','error');document.getElementById("submit_message").style.display="none";});}</script><div class=container><a href=Login.html class=back-button>返回</a><h2>忘记密码</h2><form id=reset_password_form onsubmit="return validateForm(event)"><label for=email>邮箱:</label>
<input type=email id=email name=email required>
<label for=verification_code>验证码:</label>
<input type=verification_code id=verification_code name=verification_code required>
<button type=button id=send_code_button class=verification-code-button onclick=sendVerificationCode()>发送验证码</button>
<label for=new_password>新密码:</label>
<input type=password id=new_password name=new_password required>
<label for=confirm_password>确认新密码:</label>
<input type=password id=confirm_password name=confirm_password required><div id=error_message class=error></div><div id=submit_message style=display:none>正在重置...</div><input type=submit value=重置密码></form></div>